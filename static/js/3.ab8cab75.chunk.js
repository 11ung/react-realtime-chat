(this["webpackJsonprealtime-chat"]=this["webpackJsonprealtime-chat"]||[]).push([[3],{128:function(e,t,n){"use strict";var a=n(129);n.d(t,"c",(function(){return a.a}));var c=n(33);n.d(t,"b",(function(){return c.a}));var r=n(34);n.d(t,"a",(function(){return r.a}))},129:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return d}));var a=n(11),c=n.n(a),r=n(22),s=n(14),i=n(130),o=n(0),u=n(1),l=Object(o.createContext)(),d=function(e){var t=e.children,n=Object(o.useState)([]),a=Object(s.a)(n,2),d=a[0],f=a[1],b=Object(o.useState)(null),j=Object(s.a)(b,2),v=j[0],m=j[1],x=Object(o.useState)([]),O=Object(s.a)(x,2),h=O[0],p=O[1],g=function(){var e=Object(r.a)(c.a.mark((function e(t,n){var a,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!t){e.next=7;break}return e.next=4,Object(i.d)(t);case 4:a=e.sent,r=a.data,s=a.status,r&&200===s&&n&&n();case 7:e.next=11;break;case 9:e.prev=9,e.t0=e.catch(0);case 11:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),_=function(){var e=Object(r.a)(c.a.mark((function e(t,n){var a,r,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p([]),e.next=3,Object(i.a)(t);case 3:a=e.sent,r=a.data,s=a.status,r&&200===s&&(p(r),n&&n());case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),N=function(){var e=Object(r.a)(c.a.mark((function e(t){var n,a,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.b)();case 2:n=e.sent,a=n.data,r=n.status,a&&200===r&&(f(a),t&&t(a));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(u.jsx)(l.Provider,{value:{allMessages:d,inboxeDetail:h,conversation:v,setConversation:m,doSendMessage:g,doGetInboxDetail:_,doGetListInbox:N,setInboxDetail:p},children:t})}},130:function(e,t,n){"use strict";n.d(t,"c",(function(){return a.d})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u}));var a=n(19),c=n(18),r=n.n(c),s=n(2),i=function(e){return r.a.post(s.b,e,Object(a.a)())},o=function(e){return r.a.get(s.d.replace(":recipientId",e),Object(a.a)())},u=function(){return r.a.get(s.e,Object(a.a)())}},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},136:function(e,t,n){},137:function(e,t,n){"use strict";n.d(t,"c",(function(){return b})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return m})),n.d(t,"f",(function(){return x})),n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return f}));var a=n(25);var c=n(35);function r(e){return function(e){if(Array.isArray(e))return Object(a.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(c.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var s=n(14),i=n(128),o=n(0),u=(n(131),n(12)),l=n(29),d=(n(132),n(1)),f=function(e){var t=e.className,n=void 0===t?"":t,a=e.id,c=e.label,r=e.type,s=void 0===r?"text":r,i=(e.icon,e.value),o=e.defaultValue,f=e.name,b=e.error,j=e.errorMessage,v=e.disabled,m=void 0!==v&&v,x=e.placeholder,O=void 0===x?"Please enter the value...":x,h=e.onChange,p=void 0===h?function(){}:h,g=(e.loading,e.viewOnly),_=void 0!==g&&g,N=e.maxLength,C=void 0===N?200:N,w=e.autoComplete,y=void 0===w?"off":w,S=e.refs,k=Object(l.a)(e,["className","id","label","type","icon","value","defaultValue","name","error","errorMessage","disabled","placeholder","onChange","loading","viewOnly","maxLength","autoComplete","refs"]);return Object(d.jsxs)("div",{id:a,className:"tr__field ".concat(n," ").concat(m?"disabled":""),children:[c&&Object(d.jsx)("label",{htmlFor:f,children:c}),Object(d.jsx)("div",{className:"tr__field--wrapper",children:_?Object(d.jsx)("p",{className:"label",children:o||i}):Object(d.jsx)("input",Object(u.a)({type:s,name:f,id:f,className:"tr__field-input ".concat(b?"error":""),placeholder:m?"":O,autoComplete:y,ref:S,onChange:p,value:i,defaultValue:o,maxLength:C},k),o)}),Object(d.jsx)("p",{className:"error ".concat(b&&j&&"active"),children:j})]})},b=function(){var e=Object(o.useState)(""),t=Object(s.a)(e,2),n=t[0],a=t[1],c=Object(o.useRef)(),u=Object(o.useContext)(i.c),l=u.conversation,b=u.inboxeDetail,j=u.setInboxDetail,m=Object(o.useContext)(i.a).userInfo,x=Object(o.useContext)(i.b).socket;Object(o.useEffect)((function(){return x.on("sendMessage",(function(e){var t=m._id,n=e.data,a=n.creator,c=n.recipient,s=l&&l._id;(t===a&&s===c||t===c&&s===a)&&j((function(t){return[].concat(r(t),[e.data])}))})),function(){x.off("sendMessage")}}),[l]),Object(o.useLayoutEffect)((function(){c.current.scrollHeight>c.current.offsetHeight&&(c.current.scrollTop=c.current.scrollHeight)}),[b]);var O=function(){if(n){var e={recipient:l._id,text:n};x.emit("sendMessage",e),a("")}};return Object(d.jsxs)("div",{className:"tr_messbox",children:[Object(d.jsx)("div",{className:"header",children:l&&l.fullName}),Object(d.jsx)("div",{className:"content",ref:c,children:b.length>0&&b.map((function(e,t){return Object(d.jsx)(v,{mess:e.text,isAvatar:m._id===e.recipient},t)}))}),Object(d.jsxs)("div",{className:"footer flex",children:[Object(d.jsx)(f,{className:"input-search",placeholder:"Aa",onChange:function(e){var t=e.target.value;a(t)},value:n,onKeyPress:function(e){13===e.which&&O()}}),Object(d.jsx)("button",{onClick:O,children:"send"})]})]})},j=(n(133),n.p+"static/media/default-avatar.522560c8.png"),v=function(e){var t=e.mess,n=void 0===t?"":t,a=e.isAvatar,c=void 0!==a&&a,r=e.date,s=e.className,i=void 0===s?"":s;return Object(d.jsxs)("div",{className:"item flex ".concat(i," ").concat(c?"left":"right"," mtx1 "),children:[c&&Object(d.jsx)("img",{src:j,alt:"avatar",className:"avatar-mess mrx1"}),Object(d.jsx)("div",{className:"tr_mess ",children:n}),Object(d.jsx)("div",{className:"time",children:r})]})},m=(n(134),function(e){var t=e.allMessages,n=void 0===t?[]:t,a=Object(o.useContext)(i.c),c=a.conversation,r=a.setConversation,s=function(e){r(e)};return Object(d.jsxs)("div",{className:"tr_mess-nav",children:[Object(d.jsxs)("div",{className:"tr_mess-nav__header mbx2",children:[Object(d.jsx)("h1",{children:"Chat"}),Object(d.jsx)("div",{className:"tr__field mtx1",children:Object(d.jsx)("div",{className:"tr__field--wrapper",children:Object(d.jsx)(f,{className:"input-search",placeholder:"Search in Messenger"})})})]}),Object(d.jsx)("div",{className:"tr_mess-nav__content",children:n.length>0&&n.map((function(e){return Object(d.jsx)(x,{className:"".concat(e&&e.conversation&&c&&c._id===e.conversation._id?"selected":""),userInfo:e&&e.conversation,message:e&&e.latestMessage,handleSelect:s},e&&e.conversation._id)}))})]})}),x=(n(135),function(e){var t=e.className,n=void 0===t?"":t,a=e.userInfo,c=void 0===a?{}:a,r=e.message,s=void 0===r?"":r,i=e.handleSelect,o=void 0===i?function(){}:i;return Object(d.jsxs)("div",{className:"tr_user-item flex ".concat(n),onClick:function(){return o(c)},children:[Object(d.jsx)("img",{src:j,alt:"avatar",className:"avatar mrx1"}),Object(d.jsxs)("div",{className:"tr_user-item__info",children:[Object(d.jsx)("div",{className:"tr_user-item__info-name",children:c&&c.fullName}),Object(d.jsx)("div",{className:"tr_user-item__info-mess",children:s})]})]})}),O=(n(136),function(){var e=Object(o.useContext)(i.c),t=e.allMessages,n=e.doGetListInbox,a=e.conversation,c=e.doGetInboxDetail,r=e.setConversation,s=Object(o.useContext)(i.b).socket,u=Object(o.useContext)(i.a).userInfo;return Object(o.useEffect)((function(){s.on("newMessage",(function(e){var t=u._id,a=e.data,c=a.recipient,r=a.creator;console.log(e),t!==c&&t!==r||n()})),n((function(e){r(e[0].conversation)}))}),[]),Object(o.useEffect)((function(){a&&c(a._id)}),[a]),Object(d.jsxs)("div",{className:"tr_mess-content flex ",children:[Object(d.jsx)(m,{allMessages:t}),Object(d.jsx)(b,{})]})})},138:function(e,t,n){"use strict";n.r(t);var a=n(14),c=n(0),r=n(137),s=n(13),i=(n(139),n(128)),o=n(1);t.default=function(){var e=Object(c.useState)(""),t=Object(a.a)(e,2),n=t[0],u=t[1],l=Object(c.useState)(""),d=Object(a.a)(l,2),f=d[0],b=d[1],j=Object(c.useState)(""),v=Object(a.a)(j,2),m=v[0],x=v[1],O=Object(s.e)(),h=Object(c.useContext)(i.a),p=h.doLogin,g=h.doRegister;return Object(o.jsx)("div",{className:"tr_login-page",children:Object(o.jsxs)("div",{className:"tr_login-page__form",children:[Object(o.jsx)(r.b,{className:"mbx3",label:"Name",placeholder:"Enter name",value:f,onChange:function(e){return b(e.target.value)}}),Object(o.jsx)(r.b,{className:"mbx3",label:"Email",placeholder:"Enter email",value:n,onChange:function(e){return u(e.target.value)}}),Object(o.jsx)(r.b,{className:"mbx3",label:"Password",placeholder:"Enter password",value:m,onChange:function(e){return x(e.target.value)}}),Object(o.jsx)("button",{className:"mrx2",onClick:function(){p({email:n,password:m},(function(){O.push("/")}))},children:"login"}),Object(o.jsx)("button",{onClick:function(){g({fullName:f,email:n,password:m})},children:"register"})]})})}},139:function(e,t,n){}}]);
//# sourceMappingURL=3.ab8cab75.chunk.js.map